{"version":3,"sources":["components/left/jsoneditor/component.js","components/left/editor.js","components/right/activator/activator.js","components/right/orchestrator.js","components/right/questionnaire.js","components/home.js","index.js"],"names":["Editor","this","props","json","onChangeJSON","onChangeText","jsoneditor","JSONEditor","container","modes","set","hasToUp","setHasToUp","destroy","className","ref","elem","Component","handler","setError","context","useState","useEffect","onChange","type","up","JSON","parse","e","message","j","t","Activator","id","label","value","checked","disabled","htmlFor","preferences","Orchestrator","source","data","features","filter","console","log","lunatic","savingType","questionnaire","components","handleChange","bindings","map","q","componentType","key","labelPosition","writable","zIndex","filterDescription","Questionnaire","error","vtl","setVtl","setFilter","Array","isArray","defaultProps","Home","setContext","initD","setData","initQ","setQuestionnaire","onClick","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.125bcbc0.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport JSONEditor from 'jsoneditor';\nimport 'jsoneditor/dist/jsoneditor.css';\nimport './jsoneditor.scss';\n\nclass Editor extends Component {\n  componentDidMount() {\n    const { json, onChangeJSON, onChangeText } = this.props;\n    this.jsoneditor = new JSONEditor(this.container, {\n      modes: ['tree', 'text', 'view'],\n      onChangeJSON,\n      onChangeText,\n    });\n    this.jsoneditor.set(json);\n  }\n\n  componentDidUpdate() {\n    const { json, onChangeJSON, onChangeText, hasToUp, setHasToUp } = this.props;\n    if (hasToUp) {\n      this.jsoneditor.destroy();\n      this.jsoneditor = new JSONEditor(this.container, {\n        modes: ['tree', 'text', 'view'],\n        onChangeJSON,\n        onChangeText,\n      });\n      this.jsoneditor.set(json);\n      setHasToUp(false);\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.jsoneditor) {\n      this.jsoneditor.destroy();\n    }\n  }\n\n  render() {\n    return (\n      <div\n        className=\"jsoneditor-react-container\"\n        ref={elem => {\n          this.container = elem;\n        }}\n      />\n    );\n  }\n}\n\nexport default Editor;\n\nEditor.propTypes = {\n  json: PropTypes.shape({\n    label: PropTypes.string,\n    components: PropTypes.array,\n    variables: PropTypes.array,\n  }).isRequired,\n  onChangeJSON: PropTypes.func.isRequired,\n  onChangeText: PropTypes.func.isRequired,\n  hasToUp: PropTypes.bool.isRequired,\n  setHasToUp: PropTypes.func.isRequired,\n};\n","import React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport JSONEditor from './jsoneditor/component';\n\nconst Editor = ({ json, handler, setError, context }) => {\n  const [hasToUp, setHasToUp] = useState(false);\n\n  useEffect(() => {\n    setHasToUp(true);\n  }, [context]);\n\n  const onChange = type => up => {\n    if (type === 'json') return handler(up);\n    try {\n      handler(JSON.parse(up));\n      setError('');\n    } catch (e) {\n      setError(e.message);\n    }\n  };\n  return (\n    <JSONEditor\n      json={json}\n      onChangeJSON={j => onChange('json')(j)}\n      onChangeText={t => onChange('text')(t)}\n      hasToUp={hasToUp}\n      setHasToUp={setHasToUp}\n    />\n  );\n};\n\nexport default Editor;\n\nEditor.propTypes = {\n  json: PropTypes.shape({\n    label: PropTypes.string,\n    components: PropTypes.array,\n    variables: PropTypes.array,\n  }).isRequired,\n  handler: PropTypes.func.isRequired,\n  setError: PropTypes.func.isRequired,\n  context: PropTypes.string.isRequired,\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './activator.scss';\n\nconst Activator = ({ id, label, value, onChange }) => (\n  <div className=\"activator\">\n    <input id={`activator-${id}`} type=\"checkbox\" checked={value} onChange={onChange} disabled />\n    <label htmlFor={`activator-${id}`}>{label}</label>\n  </div>\n);\n\nexport default Activator;\n\nActivator.propTypes = {\n  id: PropTypes.string.isRequired,\n  label: PropTypes.string.isRequired,\n  value: PropTypes.bool.isRequired,\n  onChange: PropTypes.func.isRequired,\n};\n","import React, { useEffect } from 'react';\nimport * as lunatic from '@inseefr/lunatic';\nimport './custom-lunatic.scss';\n\nconst preferences = ['COLLECTED'];\nconst savingType = 'COLLECTED';\n\nconst Orchestrator = ({ source, data, features, filter }) => {\n  console.log(filter);\n  const { questionnaire, components, handleChange, bindings } = lunatic.useLunatic(source, data, {\n    savingType,\n    preferences,\n    features,\n  });\n\n  console.log(lunatic.getCollectedState(questionnaire));\n\n  return (\n    <div className=\"components\">\n      {components.map(q => {\n        const { id, componentType } = q;\n        const Component = lunatic[componentType];\n        if (!Component)\n          return <h4 key={`component-${id}`}>{`${id} component type is not supported`}</h4>;\n        return (\n          <div className=\"lunatic lunatic-component\" key={`component-${id}`}>\n            <Component\n              {...q}\n              handleChange={handleChange}\n              labelPosition=\"TOP\"\n              preferences={preferences}\n              features={features}\n              bindings={bindings}\n              writable\n              zIndex={1}\n              filterDescription={filter}\n            />\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\nexport default Orchestrator;\n","import React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport Activator from './activator';\nimport Orchestrator from './orchestrator';\n\nfunction useForceUpdate() {\n  const [value, setValue] = useState(0); // integer state\n  return () => setValue(value => ++value); // update the state to force render\n}\n\nconst Questionnaire = ({ source, data, error }) => {\n  const [vtl, setVtl] = useState(true);\n  const [filter, setFilter] = useState(false);\n\n  if (error) return <h2 className=\"error\">{error}</h2>;\n  if (!Array.isArray(source.components)) return <h2 className=\"error\">Missing components</h2>;\n\n  return (\n    <div className=\"container\">\n      <Activator\n        id=\"vtl\"\n        label={`VTL interpretation (labels & filters)`}\n        value={vtl}\n        onChange={() => {\n          setVtl(!vtl);\n        }}\n      />\n      <Activator\n        id=\"filter-decsription\"\n        label={`Display filter description`}\n        value={filter}\n        onChange={() => {\n          setFilter(!filter);\n        }}\n      />\n      <h1 className=\"title\">{source.label}</h1>\n      <Orchestrator source={source} data={data} features={vtl ? ['VTL'] : []} filter={filter} />\n    </div>\n  );\n};\n\nexport default Questionnaire;\n\nQuestionnaire.defaultProps = {\n  data: {},\n  error: '',\n};\n\nQuestionnaire.propTypes = {\n  source: PropTypes.shape({\n    label: PropTypes.string,\n    components: PropTypes.array,\n    variables: PropTypes.array,\n  }).isRequired,\n  data: PropTypes.shape({\n    COLLECTED: PropTypes.objectOf(PropTypes.string),\n    CALCULATED: PropTypes.objectOf(PropTypes.string),\n    EXTERNAL: PropTypes.objectOf(PropTypes.string),\n  }),\n  error: PropTypes.string,\n};\n","import React, { useState } from 'react';\nimport { data as initD, questionnaire as initQ } from 'utils/default';\nimport Left from './left';\nimport Right from './right';\nimport './home.scss';\n\nconst Home = () => {\n  const [context, setContext] = useState('questionnaire');\n  const [data, setData] = useState(initD);\n  const [questionnaire, setQuestionnaire] = useState(initQ);\n  const [error, setError] = useState('');\n\n  const handler = context === 'questionnaire' ? setQuestionnaire : setData;\n  const json = context === 'questionnaire' ? questionnaire : data;\n\n  return (\n    <div className=\"container\">\n      <div>\n        <button type=\"button\" className=\"btn\" onClick={() => setContext('questionnaire')}>\n          Questionnaire\n        </button>\n        <button type=\"button\" className=\"btn\" onClick={() => setContext('data')}>\n          Data\n        </button>\n      </div>\n      <div className=\"panel-container\">\n        <div className=\"panel-left\">\n          <Left json={json} handler={handler} setError={setError} context={context} />\n        </div>\n        <div className=\"panel-right\">\n          <Right source={questionnaire} data={data} error={error} />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Home;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Home from 'components/home';\n\nReactDOM.render(<Home />, document.getElementById('root'));\n"],"sourceRoot":""}