{"version":3,"sources":["components/left/jsoneditor/component.js","components/left/editor.js","components/right/orchestrator.js","components/right/switch.js","components/home.js","index.js"],"names":["Editor","this","props","json","onChangeJSON","onChangeText","jsoneditor","JSONEditor","container","modes","set","hasToUp","setHasToUp","destroy","className","ref","elem","Component","handler","setError","context","useState","useEffect","onChange","type","up","JSON","parse","e","message","j","t","preferences","features","Questionnaire","source","data","error","lunatic","savingType","management","questionnaire","components","handleChange","bindings","Array","isArray","uiComponents","map","q","id","componentType","labelPosition","writable","zIndex","filterDesprition","label","defaultProps","Switch","ready","setReady","onClick","Home","setContext","initD","setData","initQ","setQuestionnaire","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.ab9261c3.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport JSONEditor from 'jsoneditor';\nimport 'jsoneditor/dist/jsoneditor.css';\nimport './jsoneditor.scss';\n\nclass Editor extends Component {\n  componentDidMount() {\n    const { json, onChangeJSON, onChangeText } = this.props;\n    this.jsoneditor = new JSONEditor(this.container, {\n      modes: ['tree', 'text', 'view'],\n      onChangeJSON,\n      onChangeText,\n    });\n    this.jsoneditor.set(json);\n  }\n\n  componentDidUpdate() {\n    const { json, onChangeJSON, onChangeText, hasToUp, setHasToUp } = this.props;\n    if (hasToUp) {\n      this.jsoneditor.destroy();\n      this.jsoneditor = new JSONEditor(this.container, {\n        modes: ['tree', 'text', 'view'],\n        onChangeJSON,\n        onChangeText,\n      });\n      this.jsoneditor.set(json);\n      setHasToUp(false);\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.jsoneditor) {\n      this.jsoneditor.destroy();\n    }\n  }\n\n  render() {\n    return (\n      <div\n        className=\"jsoneditor-react-container\"\n        ref={elem => {\n          this.container = elem;\n        }}\n      />\n    );\n  }\n}\n\nexport default Editor;\n\nEditor.propTypes = {\n  json: PropTypes.shape({\n    label: PropTypes.string,\n    components: PropTypes.array,\n    variables: PropTypes.array,\n  }).isRequired,\n  onChangeJSON: PropTypes.func.isRequired,\n  onChangeText: PropTypes.func.isRequired,\n  hasToUp: PropTypes.bool.isRequired,\n  setHasToUp: PropTypes.func.isRequired,\n};\n","import React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport JSONEditor from './jsoneditor/component';\n\nconst Editor = ({ json, handler, setError, context }) => {\n  const [hasToUp, setHasToUp] = useState(false);\n\n  useEffect(() => {\n    setHasToUp(true);\n  }, [context]);\n\n  const onChange = type => up => {\n    if (type === 'json') return handler(up);\n    try {\n      handler(JSON.parse(up));\n      setError('');\n    } catch (e) {\n      setError(e.message);\n    }\n  };\n  return (\n    <JSONEditor\n      json={json}\n      onChangeJSON={j => onChange('json')(j)}\n      onChangeText={t => onChange('text')(t)}\n      hasToUp={hasToUp}\n      setHasToUp={setHasToUp}\n    />\n  );\n};\n\nexport default Editor;\n\nEditor.propTypes = {\n  json: PropTypes.shape({\n    label: PropTypes.string,\n    components: PropTypes.array,\n    variables: PropTypes.array,\n  }).isRequired,\n  handler: PropTypes.func.isRequired,\n  setError: PropTypes.func.isRequired,\n  context: PropTypes.string.isRequired,\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport * as lunatic from '@inseefr/lunatic';\n\nconst preferences = ['COLLECTED'];\nconst savingType = 'COLLECTED';\nconst management = false;\nconst features = ['VTL'];\n\nconst Questionnaire = ({ source, data, error }) => {\n\tconst { questionnaire, components, handleChange, bindings } =\n\t\tlunatic.useLunatic(source, data, {\n\t\t\tsavingType,\n\t\t\tpreferences,\n\t\t\tfeatures,\n\t\t\tmanagement,\n\t\t});\n\n\tif (error) return <h2 className=\"error\">{error}</h2>;\n\tif (!Array.isArray(questionnaire.components))\n\t\treturn <h2 className=\"error\">Missing components</h2>;\n\n\tconst uiComponents = components.map((q) => {\n\t\tconst { id, componentType } = q;\n\t\tconst Component = lunatic[componentType];\n\t\tif (!Component)\n\t\t\treturn (\n\t\t\t\t<h4\n\t\t\t\t\tkey={`component-${id}`}\n\t\t\t\t>{`${id} component type is not supported`}</h4>\n\t\t\t);\n\t\treturn (\n\t\t\t<div className=\"lunatic lunatic-component\" key={`component-${id}`}>\n\t\t\t\t<Component\n\t\t\t\t\t{...q}\n\t\t\t\t\thandleChange={handleChange}\n\t\t\t\t\tlabelPosition=\"TOP\"\n\t\t\t\t\tpreferences={preferences}\n\t\t\t\t\tfeatures={features}\n\t\t\t\t\tbindings={bindings}\n\t\t\t\t\twritable\n\t\t\t\t\tzIndex={1}\n\t\t\t\t\tfilterDesprition={false}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t});\n\n\treturn (\n\t\t<div className=\"container\">\n\t\t\t<h1 className=\"title\">{questionnaire.label}</h1>\n\t\t\t<div className=\"components\">{uiComponents}</div>\n\t\t</div>\n\t);\n};\n\nexport default Questionnaire;\n\nQuestionnaire.defaultProps = {\n\tdata: {},\n\terror: '',\n};\n\nQuestionnaire.propTypes = {\n\tsource: PropTypes.shape({\n\t\tlabel: PropTypes.string,\n\t\tcomponents: PropTypes.array,\n\t\tvariables: PropTypes.array,\n\t}).isRequired,\n\tdata: PropTypes.shape({\n\t\tCOLLECTED: PropTypes.objectOf(PropTypes.string),\n\t\tCALCULATED: PropTypes.objectOf(PropTypes.string),\n\t\tEXTERNAL: PropTypes.objectOf(PropTypes.string),\n\t}),\n\terror: PropTypes.string,\n};\n","import React, { useState, useEffect } from 'react';\nimport Orchestrator from './orchestrator';\n\nconst Switch = ({ source, data, error }) => {\n\tconst [ready, setReady] = useState(false);\n\n\tuseEffect(() => {\n\t\tif (ready) setReady(false);\n\t\t// Assume the hack to reload Questionnaire\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [source, data]);\n\n\tif (!ready)\n\t\treturn (\n\t\t\t<div className=\"centered\">\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tclassName=\"btn-vizu\"\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tsetReady(true);\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tVisualize\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t);\n\treturn <Orchestrator source={source} data={data} error={error} />;\n};\n\nexport default Switch;\n","import React, { useState } from 'react';\nimport { data as initD, questionnaire as initQ } from 'utils/default';\nimport Left from './left';\nimport Right from './right';\nimport './home.scss';\n\nconst Home = () => {\n  const [context, setContext] = useState('questionnaire');\n  const [data, setData] = useState(initD);\n  const [questionnaire, setQuestionnaire] = useState(initQ);\n  const [error, setError] = useState('');\n\n  const handler = context === 'questionnaire' ? setQuestionnaire : setData;\n  const json = context === 'questionnaire' ? questionnaire : data;\n\n  return (\n    <div className=\"container\">\n      <div>\n        <button type=\"button\" className=\"btn\" onClick={() => setContext('questionnaire')}>\n          Questionnaire\n        </button>\n        <button type=\"button\" className=\"btn\" onClick={() => setContext('data')}>\n          Data\n        </button>\n      </div>\n      <div className=\"panel-container\">\n        <div className=\"panel-left\">\n          <Left json={json} handler={handler} setError={setError} context={context} />\n        </div>\n        <div className=\"panel-right\">\n          <Right source={questionnaire} data={data} error={error} />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Home;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Home from 'components/home';\n\nReactDOM.render(<Home />, document.getElementById('root'));\n"],"sourceRoot":""}