{"version":3,"sources":["img/lunatic-logo.png","orchestrator.js","collect/orchestrator.js","management/orchestrator.js","home.js","index.js"],"names":["module","exports","__webpack_require__","p","buildUpdatedResponse","component","preferences","valueType","value","newValue","includes","slice","indexOf","reduce","_","type","response","valueState","find","v","Object","objectSpread","__","concat","toConsumableArray","buildUpdatedVectorResponse","responses","name","cellComponent","isComponentsConcernedByResponse","push","buildUpdatedCheckboxGroupResponse","other","objectWithoutProperties","newResponses","buildUpdatedTableResponse","cells","newCells","line","responseName","filter","o","length","forEach","l","str","Orchestrator","_ref","savingType","source","data","tooltip","_useState","useState","questionnaire","components","props","filledComponents","c","mergeQuestionnaireAndData","_useState2","slicedToArray","setQuestionnaire","onChange","updatedValue","_Object$entries$","entries","componentType","updateQuestionnaire","console","log","lunatic","map","q","id","Component","react_default","a","createElement","className","key","assign","handleChange","labelPosition","CollectOrchestrator","orchestrator","simspons","ManagementOrchestrator","Home","fakeRoute","setFakeRoute","Fragment","alt","src","logo","onClick","collect_orchestrator","management_orchestrator","ReactDOM","render","home","document","getElementById"],"mappings":"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","file":"static/js/main.bf3ee898.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/lunatic-logo.f2d2cbf3.png\";","import React, { useState } from 'react';\nimport * as lunatic from '@inseefr/lunatic';\n\nconst mergeQuestionnaireAndData = questionnaire => data => {\n\tconst { components, ...props } = questionnaire;\n\tconst filledComponents = components.reduce((_, c) => [..._, c], []);\n\treturn { ...props, components: filledComponents };\n};\n\nconst updateQuestionnaire = valueType => questionnaire => preferences => updatedValue => {\n\tconst [name, value] = Object.entries(updatedValue)[0];\n\tconst components = questionnaire.components.reduce((_, c) => {\n\t\tif (!isComponentsConcernedByResponse(name)(c)) {\n\t\t\t_.push(c);\n\t\t\treturn _;\n\t\t} else if (c.response) {\n\t\t\t_.push(buildUpdatedResponse(c)(preferences)(valueType)(value));\n\t\t} else if (c.componentType === 'CheckboxGroup')\n\t\t\t_.push(\n\t\t\t\tbuildUpdatedCheckboxGroupResponse(c)(preferences)(valueType)(value)(\n\t\t\t\t\tname\n\t\t\t\t)\n\t\t\t);\n\t\telse if (c.componentType === 'Table')\n\t\t\t_.push(buildUpdatedTableResponse(c)(preferences)(valueType)(value)(name));\n\t\telse _.push(c);\n\t\treturn _;\n\t}, []);\n\treturn { ...questionnaire, components };\n};\n\nconst buildUpdatedResponse = component => preferences => valueType => value => {\n\tlet newValue = value;\n\tif (preferences.includes(valueType)) {\n\t\tconst toCheck = preferences.slice(0, preferences.indexOf(valueType));\n\t\tconst lastValue = toCheck.reduce(\n\t\t\t(_, type) =>\n\t\t\t\tcomponent.response.valueState.find(v => v.valueType === type).value ||\n\t\t\t\t_,\n\t\t\t''\n\t\t);\n\t\tif (value === lastValue) newValue = null;\n\t}\n\treturn {\n\t\t...component,\n\t\tresponse: {\n\t\t\t...component.response,\n\t\t\tvalueState: component.response.valueState.reduce((__, v) => {\n\t\t\t\tif (v.valueType === valueType)\n\t\t\t\t\treturn [...__, { ...v, value: newValue }];\n\t\t\t\treturn [...__, v];\n\t\t\t}, []),\n\t\t},\n\t};\n};\n\nconst buildUpdatedVectorResponse = responses => preferences => valueType => value => name =>\n\tresponses.reduce((_, cellComponent) => {\n\t\tif (isComponentsConcernedByResponse(name)(cellComponent))\n\t\t\t_.push(\n\t\t\t\tbuildUpdatedResponse(cellComponent)(preferences)(valueType)(value)\n\t\t\t);\n\t\telse _.push(cellComponent);\n\t\treturn _;\n\t}, []);\n\nconst buildUpdatedCheckboxGroupResponse = component => preferences => valueType => value => name => {\n\tconst { responses, ...other } = component;\n\tconst newResponses = buildUpdatedVectorResponse(responses)(preferences)(\n\t\tvalueType\n\t)(value)(name);\n\treturn { ...other, responses: newResponses };\n};\n\nconst buildUpdatedTableResponse = component => preferences => valueType => value => name => {\n\tconst { cells, ...other } = component;\n\tconst newCells = cells.reduce((_, line) => {\n\t\t_.push(\n\t\t\tbuildUpdatedVectorResponse(line)(preferences)(valueType)(value)(name)\n\t\t);\n\t\treturn _;\n\t}, []);\n\treturn { ...other, cells: newCells };\n};\n\nconst isComponentsConcernedByResponse = responseName => component =>\n\t(component.response && component.response.name === responseName) ||\n\t(component.responses &&\n\t\tcomponent.responses.filter(\n\t\t\to => o.response && o.response.name === responseName\n\t\t).length !== 0) ||\n\t(component.cells &&\n\t\tcomponent.cells\n\t\t\t.reduce((_, line) => {\n\t\t\t\tline.forEach(l => {\n\t\t\t\t\tif (l.response && l.response.name) _.push(l.response.name);\n\t\t\t\t});\n\t\t\t\treturn _;\n\t\t\t}, [])\n\t\t\t.filter(str => str === responseName).length === 1);\n\nconst Orchestrator = ({ savingType, preferences, source, data, tooltip }) => {\n\tconst [questionnaire, setQuestionnaire] = useState(\n\t\tmergeQuestionnaireAndData(source)(data)\n\t);\n\tconst onChange = updatedValue => {\n\t\tsetQuestionnaire(\n\t\t\tupdateQuestionnaire(savingType)(questionnaire)(preferences)(updatedValue)\n\t\t);\n\t};\n\tconsole.log(lunatic.getState(questionnaire));\n\tconst components = questionnaire.components.map(q => {\n\t\tconst { id, componentType } = q;\n\t\tconst Component = lunatic[componentType];\n\t\treturn (\n\t\t\t<div className=\"lunatic lunatic-component\" key={`component-${id}`}>\n\t\t\t\t<Component\n\t\t\t\t\t{...q}\n\t\t\t\t\thandleChange={onChange}\n\t\t\t\t\tlabelPosition=\"TOP\"\n\t\t\t\t\tpreferences={preferences}\n\t\t\t\t\ttooltip={tooltip}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t});\n\treturn (\n\t\t<div className=\"container\">\n\t\t\t<div className=\"components\">{components}</div>\n\t\t</div>\n\t);\n};\n\nexport default Orchestrator;\n","import React from 'react';\nimport Orchestrator from '../orchestrator';\nimport simspons from './simpsons';\nimport data from '../data';\n\nconst CollectOrchestrator = () => (\n\t<Orchestrator\n\t\tsavingType=\"COLLECTED\"\n\t\tpreferences={['COLLECTED']}\n\t\tsource={simspons}\n\t\tdata={data}\n\t/>\n);\n\nexport default CollectOrchestrator;\n","import React from 'react';\nimport Orchestrator from '../orchestrator';\nimport simspons from './simpsons';\nimport data from '../data';\n\nconst ManagementOrchestrator = () => (\n\t<Orchestrator\n\t\tsavingType=\"EDITED\"\n\t\tpreferences={['COLLECTED', 'FORCED', 'EDITED']}\n\t\tsource={simspons}\n\t\tdata={data}\n\t\ttooltip={true}\n\t/>\n);\n\nexport default ManagementOrchestrator;\n","import React, { useState } from 'react';\nimport logo from './img/lunatic-logo.png';\nimport CollectOrchestrator from './collect';\nimport ManagementOrchestrator from './management';\nimport './custom-lunatic.scss';\n\nconst Home = () => {\n\tconst [fakeRoute, setFakeRoute] = useState('/collect');\n\treturn (\n\t\t<>\n\t\t\t<div className=\"lunatic-img-container\">\n\t\t\t\t<img\n\t\t\t\t\tclassName=\"lunatic-img\"\n\t\t\t\t\talt=\"lunatic\"\n\t\t\t\t\tsrc={logo}\n\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\tfakeRoute === '/collect'\n\t\t\t\t\t\t\t? setFakeRoute('/management')\n\t\t\t\t\t\t\t: setFakeRoute('/collect')\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t{fakeRoute === '/collect' ? (\n\t\t\t\t<CollectOrchestrator />\n\t\t\t) : (\n\t\t\t\t<ManagementOrchestrator />\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default Home;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Home from './home';\nimport './index.scss';\n\nReactDOM.render(<Home />, document.getElementById('root'));\n"],"sourceRoot":""}