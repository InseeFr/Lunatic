{"version":3,"sources":["img/lunatic-logo.png","orchestrator.js","collect/orchestrator.js","management/orchestrator.js","home.js","index.js"],"names":["module","exports","__webpack_require__","p","buildUpdatedResponse","component","preferences","valueType","value","newValue","includes","slice","indexOf","reduce","_","type","response","valueState","find","v","Object","objectSpread","__","concat","toConsumableArray","buildUpdatedTableResponse","name","cells","other","objectWithoutProperties","newCells","line","push","cellComponent","isComponentsConcernedByResponse","responseName","options","filter","o","length","forEach","l","str","Orchestrator","_ref","savingType","source","tooltip","_useState","useState","_useState2","slicedToArray","questionnaire","setQuestionnaire","onChange","updatedValue","_Object$entries$","entries","components","c","componentType","console","log","updateQuestionnaire","lunatic","map","q","id","Component","react_default","a","createElement","className","key","assign","handleChange","labelPosition","CollectOrchestrator","orchestrator","simspons","ManagementOrchestrator","Home","fakeRoute","setFakeRoute","Fragment","alt","src","logo","onClick","collect_orchestrator","management_orchestrator","ReactDOM","render","home","document","getElementById"],"mappings":"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","file":"static/js/main.5d2f286c.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/lunatic-logo.f2d2cbf3.png\";","import React, { useState } from 'react';\nimport * as lunatic from '@inseefr/lunatic';\n\nconst updateQuestionnaire = valueType => questionnaire => preferences => updatedValue => {\n\tconst [name, value] = Object.entries(updatedValue)[0];\n\tconst components = questionnaire.components.reduce((_, c) => {\n\t\tif (!isComponentsConcernedByResponse(name)(c)) {\n\t\t\t_.push(c);\n\t\t\treturn _;\n\t\t} else if (c.response) {\n\t\t\t_.push(buildUpdatedResponse(c)(preferences)(valueType)(value));\n\t\t} else if (c.componentType === 'Checkbox')\n\t\t\tconsole.log('options', c.componentType);\n\t\telse if (c.componentType === 'Table')\n\t\t\t_.push(buildUpdatedTableResponse(c)(preferences)(valueType)(value)(name));\n\t\telse _.push(c);\n\t\treturn _;\n\t}, []);\n\treturn { ...questionnaire, components };\n};\n\nconst buildUpdatedResponse = component => preferences => valueType => value => {\n\tlet newValue = value;\n\tif (preferences.includes(valueType)) {\n\t\tconst toCheck = preferences.slice(0, preferences.indexOf(valueType));\n\t\tconst lastValue = toCheck.reduce(\n\t\t\t(_, type) =>\n\t\t\t\tcomponent.response.valueState.find(v => v.valueType === type).value ||\n\t\t\t\t_,\n\t\t\t''\n\t\t);\n\t\tif (value === lastValue) newValue = null;\n\t}\n\treturn {\n\t\t...component,\n\t\tresponse: {\n\t\t\t...component.response,\n\t\t\tvalueState: component.response.valueState.reduce((__, v) => {\n\t\t\t\tif (v.valueType === valueType)\n\t\t\t\t\treturn [...__, { ...v, value: newValue }];\n\t\t\t\treturn [...__, v];\n\t\t\t}, []),\n\t\t},\n\t};\n};\n\nconst buildUpdatedTableResponse = component => preferences => valueType => value => name => {\n\tconst { cells, ...other } = component;\n\tconst newCells = cells.reduce((_, line) => {\n\t\t_.push(\n\t\t\tline.reduce((__, cellComponent) => {\n\t\t\t\tif (isComponentsConcernedByResponse(name)(cellComponent))\n\t\t\t\t\t__.push(\n\t\t\t\t\t\tbuildUpdatedResponse(cellComponent)(preferences)(valueType)(value)\n\t\t\t\t\t);\n\t\t\t\telse __.push(cellComponent);\n\t\t\t\treturn __;\n\t\t\t}, [])\n\t\t);\n\t\treturn _;\n\t}, []);\n\treturn { ...other, cells: newCells };\n};\n\nconst isComponentsConcernedByResponse = responseName => component =>\n\t(component.response && component.response.name === responseName) ||\n\t(component.options &&\n\t\tcomponent.options.filter(\n\t\t\to => o.response && o.response.name === responseName\n\t\t).length !== 0) ||\n\t(component.cells &&\n\t\tcomponent.cells\n\t\t\t.reduce((_, line) => {\n\t\t\t\tline.forEach(l => {\n\t\t\t\t\tif (l.response && l.response.name) _.push(l.response.name);\n\t\t\t\t});\n\t\t\t\treturn _;\n\t\t\t}, [])\n\t\t\t.filter(str => str === responseName).length === 1);\n\nconst Orchestrator = ({ savingType, preferences, source, tooltip }) => {\n\tconst [questionnaire, setQuestionnaire] = useState(source);\n\tconst onChange = updatedValue => {\n\t\tsetQuestionnaire(\n\t\t\tupdateQuestionnaire(savingType)(questionnaire)(preferences)(updatedValue)\n\t\t);\n\t};\n\tconsole.log(lunatic.getState(questionnaire));\n\tconst components = questionnaire.components.map(q => {\n\t\tconst { id, componentType } = q;\n\t\tconst Component = lunatic[componentType];\n\t\treturn (\n\t\t\t<div className=\"lunatic lunatic-component\" key={`component-${id}`}>\n\t\t\t\t<Component\n\t\t\t\t\t{...q}\n\t\t\t\t\thandleChange={onChange}\n\t\t\t\t\tlabelPosition=\"TOP\"\n\t\t\t\t\tpreferences={preferences}\n\t\t\t\t\ttooltip={tooltip}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t});\n\treturn (\n\t\t<div className=\"container\">\n\t\t\t<div className=\"components\">{components}</div>\n\t\t</div>\n\t);\n};\n\nexport default Orchestrator;\n","import React from 'react';\nimport Orchestrator from '../orchestrator';\nimport simspons from './simpsons';\n\nconst CollectOrchestrator = () => (\n\t<Orchestrator\n\t\tsavingType=\"COLLECTED\"\n\t\tpreferences={['COLLECTED']}\n\t\tsource={simspons}\n\t/>\n);\n\nexport default CollectOrchestrator;\n","import React from 'react';\nimport Orchestrator from '../orchestrator';\nimport simspons from './simpsons';\n\nconst ManagementOrchestrator = () => (\n\t<Orchestrator\n\t\tsavingType=\"EDITED\"\n\t\tpreferences={['COLLECTED', 'FORCED', 'EDITED']}\n\t\tsource={simspons}\n\t\ttooltip={true}\n\t/>\n);\n\nexport default ManagementOrchestrator;\n","import React, { useState } from 'react';\nimport logo from './img/lunatic-logo.png';\nimport CollectOrchestrator from './collect';\nimport ManagementOrchestrator from './management';\nimport './custom-lunatic.scss';\n\nconst Home = () => {\n\tconst [fakeRoute, setFakeRoute] = useState('/collect');\n\treturn (\n\t\t<>\n\t\t\t<div className=\"lunatic-img-container\">\n\t\t\t\t<img\n\t\t\t\t\tclassName=\"lunatic-img\"\n\t\t\t\t\talt=\"lunatic\"\n\t\t\t\t\tsrc={logo}\n\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\tfakeRoute === '/collect'\n\t\t\t\t\t\t\t? setFakeRoute('/management')\n\t\t\t\t\t\t\t: setFakeRoute('/collect')\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t{fakeRoute === '/collect' ? (\n\t\t\t\t<CollectOrchestrator />\n\t\t\t) : (\n\t\t\t\t<ManagementOrchestrator />\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default Home;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Home from './home';\nimport './index.scss';\n\nReactDOM.render(<Home />, document.getElementById('root'));\n"],"sourceRoot":""}