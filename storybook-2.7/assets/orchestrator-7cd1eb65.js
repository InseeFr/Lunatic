import{j as e,b as a,u as te,c as ae,M as se,F as re,a as O,B as k,d as ie}from"./index-18f866ad.js";import{r as o,R as ne}from"./index-e67e0a49.js";const oe=({key:s,overviewEntry:t,goToPage:r})=>{let n="green";return t.reached||(n="grey"),t.visible||(n="red"),e(o.Fragment,{children:a("li",{style:{listStyle:"none",color:n},onClick:()=>r({page:t.page}),children:[a("div",{className:"row",children:[t.page,t.label]}),t.children.length>0&&e(q,{overview:t.children,goToPage:r})]})},s)},q=({overview:s,goToPage:t})=>e("ol",{children:s.map(r=>e(oe,{overviewEntry:r,goToPage:t},`view-${r.lunaticId}`))});q.__docgenInfo={description:"",methods:[],displayName:"Overview"};const le=""+new URL("preloader-9efc7014.svg",import.meta.url).href;function L({status:s,children:t}){return s?a("div",{className:"waiting",children:[e("img",{src:le,alt:"loading"}),e("div",{className:"content",children:t})]}):null}L.defaultProps={status:!1};const ce=ne.memo(L);L.__docgenInfo={description:"",methods:[],displayName:"Waiting",props:{status:{defaultValue:{value:"false",computed:!1},required:!1}}};function de(){return{}}function ue({goToPage:s,getData:t,lastReachedPage:r}){const[n,d]=o.useState(1);function u(p,l){d(l)}return a("div",{className:"dev-options",children:[a("div",{style:{display:"flex"},children:[e(k,{onClick:()=>O.log(t(!0)),children:"Get Data"}),e(k,{onClick:()=>s({page:`${n}`}),children:`Go to "${n}"`})]}),e(ie,{id:"page-to-jump",value:n,handleChange:u,min:1,label:"Page to reach : "})]})}function ge({goPrevious:s,goNext:t,goToPage:r,lastReachedPage:n,isLast:d,isFirst:u,pageTag:p,maxPage:l,getData:P,pager:h}){if(l&&l>1){const m=k;return a(re,{children:[a("div",{className:"pagination",children:[e(m,{onClick:s,disabled:u,children:"Previous"}),e(m,{onClick:t,disabled:d,children:"Next"}),e("div",{style:{fontSize:".8em",opacity:.7,marginTop:".3em"},children:"You can use PgDown / PgUp shortcut"})]}),e(ue,{goToPage:r,getData:P,lastReachedPage:n}),a("div",{className:"story-pager",children:[e("h3",{children:"Pager"}),a("ul",{children:[a("li",{children:[e("strong",{children:"PageTag:"})," ",JSON.stringify(p)]}),Object.keys(h).map(g=>a("li",{children:[a("strong",{children:[g,":"]})," ",JSON.stringify(h[g])]},g))]})]})]})}return null}function fe(s,t,r){O.log("onChange",{response:s,value:t,args:r})}function pe(){O.log("no missing strategy")}function R({source:s,data:t,management:r=!1,shortcut:n=!1,activeControls:d=!1,features:u,initialPage:p="1",getStoreInfo:l=de,missing:P=!1,missingStrategy:h=pe,missingShortcut:m,autoSuggesterLoading:g,addExternal:he,preferences:M,custom:D,showOverview:x=!1,filterDescription:_=!0,getReferentiel:j,dontKnowButton:$,refusedButton:E,readOnly:T,...me}){const{maxPage:B}=s,{getComponents:G,goPreviousPage:C,goNextPage:v,goToPage:V,pager:F,pageTag:f,isFirstPage:J,isLastPage:U,waiting:W,overview:A,compileControls:I,getData:z,Provider:H,hasPageResponse:K}=te(s,t,{initialPage:p,features:u,preferences:M,onChange:fe,custom:D,autoSuggesterLoading:g,getReferentiel:j,management:r,missing:P,missingStrategy:h,missingShortcut:m,shortcut:n,activeControls:d,withOverview:x,dontKnowButton:$,refusedButton:E}),Y=G(),{lastReachedPage:Q}=F,[y,X]=o.useState({}),[N,w]=o.useState(null),Z=o.useCallback(i=>{w(void 0),v(i)},[v]),ee=o.useCallback(()=>w(void 0),[]),S=o.useCallback(()=>{const{currentErrors:i,isCritical:c}=I();X({...y,[f]:i||{}}),i&&Object.keys(i).length>0?w({currentErrors:i,isCritical:c}):v()},[I,y,v,f]);return o.useEffect(()=>{const i=c=>{let b=!1;c.key==="PageDown"&&(S(),b=!0),c.key==="PageUp"&&(C(),b=!0),b&&(c.preventDefault(),c.stopPropagation())};return document.addEventListener("keydown",i),()=>{document.removeEventListener("keydown",i)}},[S,C]),e(H,{children:a("div",{className:"container story-with-sidebar",children:[e("div",{className:"components",children:e(ae,{autoFocusKey:f,components:Y,componentProps:({storeName:i})=>({errors:y[f],filterDescription:_,disabled:T,...i?l(i):{}})})}),a("aside",{children:[e(ge,{goPrevious:C,goNext:S,goToPage:V,lastReachedPage:Q,isLast:U,isFirst:J,pageTag:f,maxPage:B,getData:z,pager:F}),a("div",{className:"story-pager",children:[e("h3",{children:"Misc"}),e("ul",{children:a("li",{children:[e("strong",{children:"pageHasResponse:"})," ",JSON.stringify(K())]})})]}),x&&e(q,{overview:A,goToPage:V}),N&&e(se,{errors:N.currentErrors,goNext:Z,onClose:ee,isCritical:N.isCritical}),e(ce,{status:W,children:e("div",{className:"waiting-orchestrator",children:"Initialisation des donn√©es de suggestion..."})})]})]})})}const Ce=o.memo(R);R.__docgenInfo={description:"",methods:[],displayName:"OrchestratorForStories",props:{management:{defaultValue:{value:"false",computed:!1},required:!1},shortcut:{defaultValue:{value:"false",computed:!1},required:!1},activeControls:{defaultValue:{value:"false",computed:!1},required:!1},initialPage:{defaultValue:{value:"'1'",computed:!1},required:!1},getStoreInfo:{defaultValue:{value:`function getStoreInfoRequired() {
	return {};
}`,computed:!1},required:!1},missing:{defaultValue:{value:"false",computed:!1},required:!1},missingStrategy:{defaultValue:{value:`function logMissingStrategy() {
	Logger.log('no missing strategy');
}`,computed:!1},required:!1},showOverview:{defaultValue:{value:"false",computed:!1},required:!1},filterDescription:{defaultValue:{value:"true",computed:!1},required:!1}}};export{Ce as O};
//# sourceMappingURL=orchestrator-7cd1eb65.js.map
