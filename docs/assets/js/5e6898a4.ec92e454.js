(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7159],{7685:(e,n,r)=>{"use strict";r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>u,toc:()=>d});var a=r(4848),s=r(8453);const t=JSON.parse('{"$schema":"../../../lunatic-schema.json","suggesters":[{"responseNames":["VARIABLE_COMMUNE"],"name":"L_COMMUNEPASSEE-1-2-0","fields":[{"name":"label","rules":["[\\\\w]+"],"language":"French","min":3,"stemmer":false},{"name":"id","rules":["[\\\\w]+"],"language":"French","min":3,"stemmer":false}],"queryParser":{"type":"tokenized","params":{"language":"French","pattern":"[\\\\w.]+","min":3,"stemmer":false}},"version":"1"},{"responseNames":["VARIABLE_PAYS"],"name":"L_PAYS-1-2-0","fields":[{"name":"label","rules":["[\\\\w]+"],"language":"French","min":3,"stemmer":false}],"queryParser":{"type":"tokenized","params":{"language":"French","pattern":"[\\\\w.]+","min":3,"stemmer":false}},"version":"1"},{"responseNames":["VARIABLE_NATIONALITE"],"name":"L_NATIONALITE-1-2-0","fields":[{"name":"label","rules":["[\\\\w]+"],"language":"French","min":3,"stemmer":false}],"queryParser":{"type":"tokenized","params":{"language":"French","pattern":"[\\\\w.]+","min":3,"stemmer":false}},"version":"1"},{"responseNames":["VARIABLE_PCS"],"name":"L_PCS_HOMMES-1-5-0","fields":[{"name":"label","rules":["[\\\\w]+"],"language":"French","min":3,"stemmer":false,"synonyms":{"accueil":["ACCEUIL"],"\xe9chafaudage":["ECHAFFAUDAGE"],"URSSAF":["URSAF","URSAFF"],"ing\xe9nierie":["INGENIEURIE","INGENERIE","INGIENERIE"],"construction":["CONSTRUCTEUR"],"distribution":["DISTRIBUTEUR"],"fabrication":["FABRICANT"],"abattoir":["ABATOIR","ABBATOIR","ABATOIRE","ABATTOIRE"],"ascenseur":["ASCENCEUR"],"ascenseurs":["ASCENCEURS"],"assenseur":["ASSENCEUR"],"joaillerie":["JOAILLIER"],"agroalimentaire":["AGGROALIMANTAIRE","AGROALIMANTAIRE"],"alimentaires":["ALIMANTAIRE"],"agroalimentaires":["AGGROALIMANTAIRES","AGROALIMENTAIRES"]}}],"queryParser":{"type":"tokenized","params":{"language":"French","pattern":"[\\\\w.]+","min":3,"stemmer":false}},"version":"1","meloto":true,"stopWords":["a","au","dans","de","des","du","en","er","la","le","ou","sur","d","l","aux","dans","un","une","pour","avec","chez","par","les"]},{"responseNames":["VARIABLE_BAILLEURS_SOCIAUX"],"name":"bailleurs_sociaux-1-5-0","fields":[{"name":"label","rules":["[\\\\w]+"],"language":"French","min":3,"stemmer":false}],"queryParser":{"type":"tokenized","params":{"language":"French","pattern":"[\\\\w.]+","min":3,"stemmer":false}},"version":"1"}],"components":[{"componentType":"Suggester","response":{"name":"VARIABLECO"},"optionResponses":[{"name":"VARIABLECO_NAME","attribute":"label"}],"storeName":"L_COMMUNEPASSEE-1-2-0","hierarchy":{"sequence":{"id":"lt4fhgd6","page":"1","label":{"type":"VTL|MD","value":"\\"I - \\" || \\"Sequence\\""}}},"conditionFilter":{"type":"VTL","value":"true"},"id":"lt4ezymk","page":"1","label":{"type":"VTL|MD","value":"\\"\u27a1 1. \\" || \\"Variable Commune\\""},"optionLabel":{"type":"VTL","value":"\\"id || \\" - \\" || label\\""},"mandatory":false,"maxLength":249},{"componentType":"Suggester","response":{"name":"VARIABLEPA"},"storeName":"L_PAYS-1-2-0","conditionFilter":{"type":"VTL","value":"true"},"id":"lt4fjoev","page":"2","label":{"type":"VTL|MD","value":"\\"\u27a1 2. \\" || \\"Variable Pays\\""},"mandatory":false,"maxLength":249},{"componentType":"Suggester","storeName":"L_NATIONALITE-1-2-0","response":{"name":"VARIABLENA"},"conditionFilter":{"type":"VTL","value":"true"},"id":"lt4f6i2y","page":"3","label":{"type":"VTL|MD","value":"\\"\u27a1 3. \\" || \\"Variable Nationalit\xe9\\""},"mandatory":false,"maxLength":249},{"componentType":"Suggester","storeName":"L_PCS_HOMMES-1-5-0","response":{"name":"VARIABLE_P"},"conditionFilter":{"type":"VTL","value":"true"},"id":"lt4f9q1o","page":"4","label":{"type":"VTL|MD","value":"\\"\u27a1 4. \\" || \\"VARIABLE_PCS\\""},"mandatory":false,"maxLength":249},{"componentType":"Suggester","storeName":"bailleurs_sociaux-1-5-0","response":{"name":"VARIABLE_B"},"conditionFilter":{"type":"VTL","value":"true"},"id":"lt4f8uba","page":"5","label":{"type":"VTL|MD","value":"\\"\u27a1 5. \\" || \\"VARIABLE_BAILLEURS_SOCIAUX\\""},"mandatory":false,"maxLength":249}],"pagination":"question","resizing":{},"label":{"type":"VTL|MD","value":"Suggester"},"lunaticModelVersion":"2.5.0","modele":"SUGGESTER","enoCoreVersion":"2.7.1","generatingDate":"27-02-2024 13:43:43","missing":false,"id":"lt4f6mib","maxPage":"5","variables":[{"variableType":"COLLECTED","values":{"COLLECTED":null,"EDITED":null,"INPUTTED":null,"FORCED":null,"PREVIOUS":null},"name":"COMMENT_QE"},{"variableType":"COLLECTED","values":{"COLLECTED":null,"EDITED":null,"INPUTTED":null,"FORCED":null,"PREVIOUS":null},"name":"VARIABLECO"},{"variableType":"COLLECTED","values":{"COLLECTED":null,"EDITED":null,"INPUTTED":null,"FORCED":null,"PREVIOUS":null},"name":"VARIABLECO_NAME"},{"variableType":"COLLECTED","values":{"COLLECTED":null,"EDITED":null,"INPUTTED":null,"FORCED":null,"PREVIOUS":null},"name":"VARIABLEPA"},{"variableType":"COLLECTED","values":{"COLLECTED":null,"EDITED":null,"INPUTTED":null,"FORCED":null,"PREVIOUS":null},"name":"VARIABLENA"},{"variableType":"COLLECTED","values":{"COLLECTED":null,"EDITED":null,"INPUTTED":null,"FORCED":null,"PREVIOUS":null},"name":"VARIABLE_P"},{"variableType":"COLLECTED","values":{"COLLECTED":null,"EDITED":null,"INPUTTED":null,"FORCED":null,"PREVIOUS":null},"name":"VARIABLE_B"},{"variableType":"CALCULATED","expression":{"type":"VTL","value":"true"},"name":"FILTER_RESULT_VARIABLECO","inFilter":"false"},{"variableType":"CALCULATED","expression":{"type":"VTL","value":"true"},"name":"FILTER_RESULT_VARIABLEPA","inFilter":"false"},{"variableType":"CALCULATED","expression":{"type":"VTL","value":"true"},"name":"FILTER_RESULT_VARIABLENA","inFilter":"false"},{"variableType":"CALCULATED","expression":{"type":"VTL","value":"true"},"name":"FILTER_RESULT_VARIABLE_P","inFilter":"false"},{"variableType":"CALCULATED","expression":{"type":"VTL","value":"true"},"name":"FILTER_RESULT_VARIABLE_B","inFilter":"false"}]}');var l=r(1415);const i={},o="Suggester",u={id:"components/fields/suggester",title:"Suggester",description:"Le composant de Suggester permet d'avoir un menu d\xe9roulant avec une option de recherche.",source:"@site/docs/components/fields/suggester.mdx",sourceDirName:"components/fields",slug:"/components/fields/suggester",permalink:"/Lunatic/docs/components/fields/suggester",draft:!1,unlisted:!1,editUrl:"https://github.com/InseeFr/Lunatic/tree/3.0/docs/docs/components/fields/suggester.mdx",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Dropdown",permalink:"/Lunatic/docs/components/fields/dropdown"},next:{title:"Radio",permalink:"/Lunatic/docs/components/fields/radio"}},c={},d=[{value:"Indexation",id:"indexation",level:2},{value:"R\xe9cup\xe9ration des donn\xe9es de la nomenclature",id:"r\xe9cup\xe9ration-des-donn\xe9es-de-la-nomenclature",level:2},{value:"Valeur arbitraire",id:"valeur-arbitraire",level:2}];function p(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"suggester",children:"Suggester"}),"\n",(0,a.jsxs)(n.p,{children:["Le composant de ",(0,a.jsx)(n.code,{children:"Suggester"})," permet d'avoir un menu d\xe9roulant avec une option de recherche."]}),"\n","\n",(0,a.jsx)(l.L,{source:t}),"\n",(0,a.jsx)(n.h2,{id:"indexation",children:"Indexation"}),"\n",(0,a.jsxs)(n.p,{children:["Dans le fichier source la liste des donn\xe9es \xe0 rendre disponible et d\xe9finit dans la propri\xe9t\xe9 ",(0,a.jsx)(n.code,{children:"suggesters"}),". Vous pouvez retrouver les d\xe9tails sur le format de cette d\xe9finition en regardant le type ",(0,a.jsx)(n.a,{href:"https://github.com/InseeFr/Lunatic/blob/3.0/src/use-lunatic/type-source.ts",children:"SuggesterType"})," dans le code source. Il y a 3 parties importantes :"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"fields"}),", permet de d\xe9finir les champs qui vont \xeatre index\xe9 pour la recherche."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"queryParser"}),", permet de d\xe9finir les r\xe8gles \xe0 appliquer \xe0 la chaine de recherche."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"name"}),", nom de la nomenclature, qui sera utilis\xe9 dans la propri\xe9t\xe9 ",(0,a.jsx)(n.code,{children:"storeName"})," du composant mais aussi pour la r\xe9cup\xe9ration de la nomenclature dans ",(0,a.jsx)(n.code,{children:"getReferentiel()"})," ."]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Lors de l'initialisation de Lunatic \xe0 l'aide du hook ",(0,a.jsx)(n.code,{children:"useLunatic()"})," il faut pr\xe9ciser l'option ",(0,a.jsx)(n.code,{children:"getReferentiel()"})," qui permet d'indiquer comment charger les donn\xe9es associ\xe9es au r\xe9f\xe9rentiel :"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"const {} = useLunatic(source, data, {\n    //...\n    getReferentiel: async (name) => {\n\t    return fetch(`https://insee.fr/referentiel/${name}.json`).then((r) => r.json());\n\t}\n})\n"})}),"\n",(0,a.jsxs)(n.p,{children:["La nomenclature doit n\xe9cessairement contenir un champ ",(0,a.jsx)(n.code,{children:"id"})," qui doit \xeatre unique pour chaque enregistrement et ",(0,a.jsx)(n.code,{children:"label"})," qui sert \xe0 l'affichage des options dans le suggester mais peut aussi contenir d'autre champs."]}),"\n",(0,a.jsx)(n.h2,{id:"r\xe9cup\xe9ration-des-donn\xe9es-de-la-nomenclature",children:"R\xe9cup\xe9ration des donn\xe9es de la nomenclature"}),"\n",(0,a.jsx)(n.p,{children:"Lors de la s\xe9lection on peut vouloir r\xe9cup\xe9rer des informations suppl\xe9mentaires dans la nomenclature (cat\xe9gorie d'un produit, unit\xe9, prix...)."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'[\n\t{\n\t\t"id": "brosse",\n\t\t"label": "Brosse \xe0 cheveux",\n\t\t"price": 20\n\t},\n\t{\n\t\t"id": "balle",\n\t\t"label": "Balle rebondissante",\n\t\t"price": 10\n\t}\n]\n'})}),"\n",(0,a.jsx)(n.p,{children:"Dans ce cas, il est possible d'ajoute une option dans le JSON afin d'envoyer la donn\xe9es de certains champs dans des variables sp\xe9cifique lors d'un choix."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n    "componentType": "Suggester",\n    "response": {\n        "name": "PRODUCT"\n    },\n    "optionResponses": [\n        {\n            "name": "PRODUCT_NAME",\n            "attribute": "label"\n        },\n        {\n            "name": "PRODUCT_PRICE",\n            "attribute": "price"\n        }\n    ]\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Lors de la s\xe9lection d'un \xe9l\xe9ment"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"PRODUCT"})," recevra l'ID du produit"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"PRODUCT_NAME"})," recevra son libell\xe9"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"PRODUCT_PRICE"})," recevra son prix"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"valeur-arbitraire",children:"Valeur arbitraire"}),"\n",(0,a.jsxs)(n.p,{children:["Il est possible de permettre \xe0 l'utilisateur de rentrer une valeur arbitraire si aucune option ne correspond \xe0 sa recherche.\nDans ce cas-l\xe0, il faudra ajouter un champ ",(0,a.jsx)(n.code,{children:"arbitrary"})," pour permettre de sauvegarder cette valeur arbitraire."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n    "componentType": "Suggester",\n    "response": {\n        "name": "PRODUCT"\n    },\n    "arbitrary": {\n        "response": { "name": "PRODUCT_OTHER" }\n    }\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Le champ ",(0,a.jsx)(n.code,{children:"arbitrary.response"})," d\xe9finit la variable qui recevra la valeur arbitraire."]})]})}function m(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},1415:(e,n,r)=>{"use strict";r.d(n,{L:()=>p});const a={FormExample:"FormExample_a30K",FormExampleRender:"FormExampleRender_QfqF",FormExampleCode:"FormExampleCode_XePV","margin-top--md":"margin-top--md_TH4F"};var s=r(9489),t=r(7227),l=r(2250);const i="import {\n  type LunaticData,\n  type LunaticSource,\n  useLunatic,\n  LunaticComponents,\n} from '@inseefr/lunatic';\nimport '@inseefr/lunatic/lib/main.css'\n\ntype Props = {\n  source: LunaticSource;\n  data: LunaticData;\n};\n\nexport function FormRenderer({ source, data }: Props) {\n  const { getComponents, Provider } = useLunatic(source, data, {\n    initialPage: '1',\n  });\n  return (\n    <Provider>\n      <LunaticComponents components={getComponents()} />\n    </Provider>\n  );\n}\n",o="import {\n  type LunaticData,\n  type LunaticSource,\n  type LunaticState,\n  useLunatic,\n  LunaticComponents,\n  ModalControls,\n} from '@inseefr/lunatic';\nimport { useState } from 'react';\n\ntype Props = {\n  source: LunaticSource;\n  data: LunaticData;\n  options?: {initialPage?: LunaticState['pageTag']},\n};\n\nexport function FormRendererWithNavigation({ source, data, options }: Props) {\n  const {\n    getComponents,\n    isLastPage,\n    isFirstPage,\n    goPreviousPage,\n    goNextPage,\n    Provider,\n    compileControls,\n  } = useLunatic(source, data, {\n    initialPage: '1' as LunaticState['pageTag'],\n    ...options\n  });\n\n  // Les contr\xf4les doivent \xeatre v\xe9rifi\xe9s manuellement\n  const [errors, setErrors] = useState<ReturnType<typeof compileControls>>();\n  const handleNext = () => {\n    const currentPageErrors = compileControls();\n    if (currentPageErrors.currentErrors) {\n      setErrors(currentPageErrors);\n    } else {\n      goNextPage();\n    }\n  };\n  const forceNext = () => {\n    setErrors(undefined);\n    goNextPage();\n  };\n  const closeModal = () => {\n    setErrors(undefined);\n  };\n\n  return (\n    <div>\n      <Provider>\n        <LunaticComponents\n          components={getComponents()}\n          componentProps={() => ({\n            errors: errors?.currentErrors,\n          })}\n        />\n      </Provider>\n      <div style={{ marginTop: '.7rem', display: 'flex', gap: '.2rem' }}>\n        <button className=\"button button--primary\" disabled={isFirstPage} onClick={goPreviousPage}>\n          Pr\xe9c\xe9dent\n        </button>\n        <button className=\"button button--primary\" disabled={isLastPage} onClick={handleNext}>\n          Suivant\n        </button>\n      </div>\n      {errors && (\n        <ModalControls\n          errors={errors.currentErrors}\n          goNext={forceNext}\n          onClose={closeModal}\n          isCritical={errors.isCritical}\n        />\n      )}\n    </div>\n  );\n}\n";var u=r(9813),c=r(4848);const d={};function p(e){let{source:n,data:p=d,options:m}=e;const E=n.maxPage&&"1"!==n.maxPage;return(0,c.jsxs)("div",{className:a.FormExample,children:[(0,c.jsxs)(s.A,{children:[(0,c.jsx)(t.A,{value:"source",label:"Source",default:!0,children:(0,c.jsx)(l.A,{language:"json",className:a.FormExampleCode,children:JSON.stringify(n,null,2)})}),(0,c.jsx)(t.A,{value:"data",label:"Data",children:(0,c.jsx)(l.A,{language:"json",className:a.FormExampleCode,children:JSON.stringify(p,null,2)})})]}),(0,c.jsxs)(s.A,{children:[(0,c.jsx)(t.A,{value:"code",label:"Code",children:(0,c.jsx)(l.A,{language:"tsx",className:a.FormExampleCode,children:E?o:i})}),(0,c.jsx)(t.A,{value:"render",label:"Rendu",default:!0,children:(0,c.jsx)("div",{className:a.FormExampleRender,children:(0,c.jsx)(u.A,{fallback:(0,c.jsx)("div",{children:"Loading..."}),children:()=>{const e=E?r(2937).g:r(7171).S;return(0,c.jsx)(e,{source:n,data:p,options:m})}})})})]})]})}},7171:(e,n,r)=>{"use strict";r.d(n,{S:()=>t});var a=r(2612),s=r(4848);function t(e){let{source:n,data:r}=e;const{getComponents:t,Provider:l}=(0,a.O1)(n,r,{initialPage:"1"});return(0,s.jsx)(l,{children:(0,s.jsx)(a.R2,{components:t()})})}},2937:(e,n,r)=>{"use strict";r.d(n,{g:()=>l});var a=r(2612),s=r(6540),t=r(4848);function l(e){let{source:n,data:r,options:l}=e;const{getComponents:i,isLastPage:o,isFirstPage:u,goPreviousPage:c,goNextPage:d,Provider:p,compileControls:m}=(0,a.O1)(n,r,{initialPage:"1",...l}),[E,g]=(0,s.useState)();return(0,t.jsxs)("div",{children:[(0,t.jsx)(p,{children:(0,t.jsx)(a.R2,{components:i(),componentProps:()=>({errors:E?.currentErrors})})}),(0,t.jsxs)("div",{style:{marginTop:".7rem",display:"flex",gap:".2rem"},children:[(0,t.jsx)("button",{className:"button button--primary",disabled:u,onClick:c,children:"Pr\xe9c\xe9dent"}),(0,t.jsx)("button",{className:"button button--primary",disabled:o,onClick:()=>{const e=m();e.currentErrors?g(e):d()},children:"Suivant"})]}),E&&(0,t.jsx)(a.I1,{errors:E.currentErrors,goNext:()=>{g(void 0),d()},onClose:()=>{g(void 0)},isCritical:E.isCritical})]})}},5053:()=>{},5843:()=>{}}]);