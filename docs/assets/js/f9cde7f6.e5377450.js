"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3553],{2794:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>a,frontMatter:()=>o,metadata:()=>c,toc:()=>d});var s=r(4848),t=r(8453);const o={},i="Gestion des contr\xf4les",c={id:"hook/controls",title:"Gestion des contr\xf4les",description:"Les contr\xf4les permettent de d\xe9finir les r\xe8gles de validation dans le questionnaire (sous forme d'expression VTL). Le hook useLunatic fournit une fonction compileControls permettant d'ex\xe9cuter ces contr\xf4les et de r\xe9cup\xe9rer les erreurs.",source:"@site/docs/hook/controls.mdx",sourceDirName:"hook",slug:"/hook/controls",permalink:"/Lunatic/docs/hook/controls",draft:!1,unlisted:!1,editUrl:"https://github.com/InseeFr/Lunatic/tree/3.0/docs/docs/hook/controls.mdx",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Navigation",permalink:"/Lunatic/docs/hook/navigation"},next:{title:"Afficher le formulaire",permalink:"/Lunatic/docs/components/lunatic-components"}},l={},d=[{value:"Structure d&#39;un contr\xf4le",id:"structure-dun-contr\xf4le",level:2},{value:"Utilisation des contr\xf4les dans les orchestrateurs",id:"utilisation-des-contr\xf4les-dans-les-orchestrateurs",level:2}];function u(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"gestion-des-contr\xf4les",children:"Gestion des contr\xf4les"})}),"\n",(0,s.jsxs)(n.p,{children:["Les contr\xf4les permettent de d\xe9finir les r\xe8gles de validation dans le questionnaire (sous forme d'expression VTL). Le hook ",(0,s.jsx)(n.code,{children:"useLunatic"})," fournit une fonction ",(0,s.jsx)(n.code,{children:"compileControls"})," permettant d'ex\xe9cuter ces contr\xf4les et de r\xe9cup\xe9rer les erreurs."]}),"\n",(0,s.jsx)(n.h2,{id:"structure-dun-contr\xf4le",children:"Structure d'un contr\xf4le"}),"\n",(0,s.jsx)(n.p,{children:"Les contr\xf4les sont d\xe9finis au niveau des composants dans la source. Chaque contr\xf4le poss\xe8de les caract\xe9ristiques suivantes :"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Criticit\xe9 :"})," Peut \xeatre d\xe9finie comme information, avertissement ou erreur."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Type de contr\xf4le :"})," Peut \xeatre de format ou de coh\xe9rence."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Expression :"})," D\xe9finit la condition d'affichage du contr\xf4le."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Message d'erreur :"})," Message affich\xe9 en cas de non-validation du contr\xf4le."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"L'expression et le message d'erreur peuvent \xeatre dynamiques et personnalis\xe9es via le VTL. La structure TypeScript d'un contr\xf4le est la suivante :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"export type ControlType = {\n    id: string;\n    criticality: 'INFO' | 'WARN' | 'ERROR';\n    typeOfControl: 'FORMAT' | 'CONSISTENCY';\n    control: {value: string, type: 'VTL'};\n    errorMessage: {value: string, type: 'VTL' | 'VTL|MD' | 'TXT'};\n    bindingDependencies?: string[];\n    type?: 'roundabout' | 'ROW' | 'simple';\n    iterations?: number;\n};\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Les types ",(0,s.jsx)(n.code,{children:"'roundabout'"})," et ",(0,s.jsx)(n.code,{children:"'ROW'"})," d\xe9finissent des contr\xf4les sp\xe9cifiques. ",(0,s.jsx)(n.code,{children:"'ROW'"})," est utilis\xe9 uniquement dans un tableau pour d\xe9finir un contr\xf4le de ligne, tandis que ",(0,s.jsx)(n.code,{children:"'roundabout'"})," est utilis\xe9 dans le composant rond-point."]}),"\n",(0,s.jsx)(n.h2,{id:"utilisation-des-contr\xf4les-dans-les-orchestrateurs",children:"Utilisation des contr\xf4les dans les orchestrateurs"}),"\n",(0,s.jsxs)(n.p,{children:["Le hook Lunatic fournit la fonction ",(0,s.jsx)(n.code,{children:"compileControls"}),", qui permet de r\xe9cup\xe9rer la liste des erreurs courantes ainsi qu'un bool\xe9en ",(0,s.jsx)(n.code,{children:"isCritical"}),". Ce dernier vaut ",(0,s.jsx)(n.code,{children:"true"})," lorsqu'il y a une erreur avec une criticit\xe9 ",(0,s.jsx)(n.code,{children:"ERROR"})," ou de type de contr\xf4le ",(0,s.jsx)(n.code,{children:"FORMAT"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Les composants peuvent ensuite utiliser ces erreurs en tant que propri\xe9t\xe9s pour les afficher."}),"\n",(0,s.jsxs)(n.p,{children:["Par exemple, en utilisant ",(0,s.jsx)(n.code,{children:"compileControls"})," \xe0 chaque changement de page :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"const [errors, setErrors] = useState();\n\nconst handleGoNext = () => {\n    const { currentErrors } = compileControls();\n    setErrors(currentErrors);\n    if (!currentErrors) {\n        goNextPage();\n    }\n};\n\nreturn (\n    <>\n        {/* ... */}\n        <LunaticComponents\n            components={components}\n            componentProps={() => ({\n                // highlight-start\n                errors: errors,\n                // highlight-end\n            })}\n        />\n        {/* ... */}\n    </>\n);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Dans cet exemple, ",(0,s.jsx)(n.code,{children:"currentErrors"})," contient les erreurs actuelles retourn\xe9es par ",(0,s.jsx)(n.code,{children:"compileControls"}),". Si aucune erreur n'est pr\xe9sente, la fonction ",(0,s.jsx)(n.code,{children:"goNextPage()"})," est appel\xe9e pour passer \xe0 la page suivante."]})]})}function a(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}}}]);